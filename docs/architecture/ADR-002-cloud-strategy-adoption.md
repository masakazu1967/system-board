# ADR-002: パブリッククラウド採用戦略

**ステータス**: 条件付き採用
**決定日**: 2025年9月13日
**決定者**: ソフトウェアアーキテクト、セキュリティエンジニア、データベースアーキテクト、DevOpsエンジニア

## コンテキスト

System Boardプロジェクトでは、当初オンプレミス環境での構築を想定していました。しかし、以下の状況変化により、パブリッククラウドの採用が検討されました：

1. **企業方針の変更**: パブリッククラウド採用が推奨される方向性
2. **オンプレミス環境の未構築**: インフラストラクチャがまだ整備されていない状況
3. **運用効率の向上**: マネージドサービスによる運用負荷軽減の期待
4. **スケーラビリティの要求**: 将来的な拡張性への対応

## 検討した選択肢

### 選択肢1: オンプレミス構築の継続

- **メリット**:
  - 完全なデータ主権の確保
  - ネットワーク分離による高いセキュリティ
  - 運用コストの予測可能性
- **デメリット**:
  - インフラ構築に必要な初期投資と時間
  - 運用・保守の人的コスト
  - スケーラビリティの制限

### 選択肢2: ハイブリッドクラウド戦略

- **メリット**:
  - 機密データはオンプレミス、運用データはクラウド
  - 段階的移行の可能性
- **デメリット**:
  - 複雑な管理体制
  - データ同期の課題
  - 両方の環境維持コスト

### 選択肢3: パブリッククラウドフルアダプション

- **メリット**:
  - マネージドサービスによる運用効率化
  - 高い可用性とスケーラビリティ
  - 初期投資の軽減
- **デメリット**:
  - データ主権に関するセキュリティリスク
  - 継続的なランニングコスト
  - ベンダーロックインのリスク

## 決定内容

**パブリッククラウドを条件付きで採用**:

以下の厳格な条件を満たすことを前提として、パブリッククラウドの採用を決定しました：

### セキュリティ要件

#### データローカライゼーション

- **日本リージョン限定**: 全データの日本国内保持
- **国境越えデータ転送の禁止**: GDPR/個人情報保護法への準拠
- **データ主権の確保**: 企業によるデータ完全管理

#### 暗号化要件

- **BYOK (Bring Your Own Key)**: 企業管理の暗号化キー
- **保存時暗号化**: AES-256による全データ暗号化
- **通信暗号化**: TLS 1.3による全通信保護

#### ネットワークセキュリティ

- **VPCマイクロセグメンテーション**: セキュリティレベル別ネットワーク分離
- **専用セキュリティサブネット**: 機密データ専用の隔離環境
- **標準監視サブネット**: 運用データ用の分離環境

### 実装フェーズ

#### Phase 1: セキュリティ基盤整備（4週間）

- セキュリティ要件の詳細化と検証
- VPCアーキテクチャの設計・構築
- 暗号化機能の実装・テスト

#### Phase 2: 段階的移行（6週間）

- 非機密データから開始
- セキュリティ監査の実施
- 機密データの移行（条件クリア後）

#### Phase 3: 最適化・監視（3週間）

- パフォーマンス最適化
- セキュリティ監視強化
- コンプライアンス確認

## セキュリティリスク評価

### 統合リスクマトリクス

| リスク項目 | リスクレベル | 対策 | 実装期限 |
|------------|-------------|------|----------|
| 脆弱性情報の外部漏洩 | 🔴 CRITICAL | BYOK暗号化必須 | Phase 1 |
| 国境越えデータ転送 | 🔴 HIGH | 日本リージョン限定 | Phase 1 |
| クラウド運用者アクセス | 🟠 MEDIUM-HIGH | カスタマーキー管理 | Phase 1 |
| データ完全性 | 🟠 MEDIUM | バックアップ・監査ログ | Phase 2 |

### 追加コスト影響

- **年間セキュリティ強化コスト**: +$25,000見込み
- **専用セキュリティ機能**: BYOK、VPC設計、監視強化
- **コンプライアンス対応**: 監査・認証取得費用

## マネージドサービス戦略

### データベース戦略

- **PostgreSQL**: クラウドマネージドサービス採用（RDS/Azure Database等）
- **EventStore DB**: コンテナベース自己管理 + クラウド最適化
- **Redis**: マネージドサービス採用推奨（ElastiCache/Azure Cache等）

### 監視・運用サービス

- **ログ管理**: Grafana Loki採用
- **メトリクス**: Prometheus + Grafana
- **アラート**: Microsoft Teams統合

## 影響

### ポジティブな影響

- **運用効率向上**: マネージドサービスによる工数削減
- **高可用性**: クラウドプロバイダーのSLA活用
- **スケーラビリティ**: オンデマンドでのリソース拡張
- **災害復旧**: クラウドプロバイダーのDR機能活用

### 課題とリスク

- **セキュリティ要件**: 製造業基準への完全準拠が必要
- **コスト管理**: 継続的なランニングコスト監視
- **ベンダーロックイン**: マルチクラウド戦略の検討必要
- **データ主権**: 法的要件への継続的な準拠確認

## 継続検討事項

1. **セキュリティ要件完全クリア**: 3ヶ月以内の実証
2. **コスト効果分析**: 6ヶ月間の運用実績評価
3. **マルチクラウド戦略**: ベンダーロックイン回避の検討
4. **オンプレミス回帰オプション**: 必要時の移行計画策定

## 関連するADR

- ADR-001: オニオンアーキテクチャ採用
- ADR-003: 監視スタック変更（Grafana Loki採用）
- ADR-005: セキュリティ強化戦略

## 参照

- アーキテクチャ変更会議議事録 (2025-09-13)
- セキュリティ要件詳細化ドキュメント
- パブリッククラウドセキュリティ設計
