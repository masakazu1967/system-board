# Architecture Decision Records (ADR) インデックス

System Boardプロジェクトにおけるアーキテクチャ決定記録（ADR）の索引と概要。

## ADRの目的

このADRシリーズは、System Boardプロジェクトにおける重要なアーキテクチャ決定を記録し、その経緯と理由を明確にすることを目的としています。製造業のセキュリティ要件を満たしながら、AI主導開発によって段階的に構築される本システムの設計思想を後から参照できるように整理されています。

## ADR一覧

### [ADR-001: ヘキサゴナルアーキテクチャからオニオンアーキテクチャへの変更](./ADR-001-hexagonal-to-onion-architecture.md)

**決定日**: 2025年9月13日
**ステータス**: 採用

**概要**: 当初採用予定だったヘキサゴナルアーキテクチャから、ドメイン駆動設計（DDD）とEvent Sourcing/CQRSの実装に適したオニオンアーキテクチャへの変更決定。

**主要な決定要因**:

- DDD実装における明確なレイヤー分離の実現
- Event Sourcing/CQRSとの高い親和性
- 長期保守性とテスタビリティの大幅向上

### [ADR-002: パブリッククラウド採用戦略](./ADR-002-cloud-strategy-adoption.md)

**決定日**: 2025年9月13日
**ステータス**: 条件付き採用

**概要**: オンプレミス構築からパブリッククラウド採用への方針転換。製造業の厳格なセキュリティ要件を満たす条件付きでの採用決定。

**主要な決定要因**:

- 企業方針の変更とオンプレミス環境未構築
- マネージドサービスによる運用効率向上
- 厳格なセキュリティ要件（日本リージョン限定、BYOK暗号化等）

### [ADR-003: 監視スタックの進化 - Sentryからセルフホステッド、そしてGrafana Lokiへ](./ADR-003-monitoring-stack-evolution.md)

**決定日**: 2025年9月13日（最終決定）
**ステータス**: 採用

**概要**: 監視システムの複数段階での検討・変更の経緯。Sentry検討・見送り、自己ホスティング検討を経て、最終的にGrafana Lokiを中心とした統合監視スタックの採用。

**主要な決定要因**:

- セキュリティ要件（情報漏洩防止優先）
- 運用工数削減（ELKスタックから40%削減）
- Prometheusエコシステムとの統合性

### [ADR-004: モジュラーモノリスから段階的マイクロサービス化戦略](./ADR-004-modular-monolith-to-microservices.md)

**決定日**: 2025年9月13日
**ステータス**: 採用

**概要**: 当初の「一足飛びマイクロサービス」方針から、現実的なモジュラーモノリス→段階的マイクロサービス化戦略への変更。

**主要な決定要因**:

- 個人プロジェクトでの実装複雑性管理
- MVP優先での段階的機能追加
- 将来のマイクロサービス分離準備

### [ADR-005: 技術スタック決定の統合的な経緯](./ADR-005-technology-stack-decisions.md)

**決定日**: 2025年9月11日〜2025年9月13日（段階的決定）
**ステータス**: 採用

**概要**: プロジェクト全体の技術スタック選定の経緯と最終決定の統合記録。フロントエンド、バックエンド、データ層、監視、セキュリティの全技術選択。

**主要な決定要因**:

- TypeScript統一による型安全性
- 製造業セキュリティ要件への完全準拠
- 無料/OSS制約下での最適選択

### [セキュリティアスペクト指向プログラミング（AOP）設計書](./security-aop-design.md)

**作成日**: 2025年9月28日
**ステータス**: 設計完了

**概要**: セキュリティ横断的関心事をアスペクト指向プログラミング（AOP）により自動化し、コードの重複排除と記述漏れ防止を実現する設計書。

**主要な設計要素**:

- 認可チェック（コマンド実行前）
- 監査ログ（成功時・失敗時の両方）
- PII保護（ログ出力時・エラー処理時）
- デコレーターベース宣言的セキュリティ
- インターセプターによる自動適用

## アーキテクチャ決定の特徴

### 決定プロセスの特徴

1. **AI主導開発**: 各専門エージェントによる技術評価
2. **セキュリティ最優先**: 製造業要件の厳格な適用
3. **段階的進化**: MVP→段階的拡張のアプローチ
4. **制約条件重視**: 無料/OSS、個人プロジェクトでの現実的選択

### 一貫した設計思想

1. **情報漏洩防止最優先**: 全ての技術選択の基準
2. **型安全性**: TypeScript統一による品質確保
3. **将来拡張性**: 段階的進化を前提とした設計
4. **運用現実性**: 個人プロジェクトでの実装・運用可能性

## 意思決定の変遷パターン

### パターン1: セキュリティ要件による見送り・変更

- **Sentry見送り**: セキュリティリスク > 運用効率
- **パブリッククラウド条件付き採用**: セキュリティ強化前提での採用

### パターン2: 実装現実性による段階化

- **マイクロサービス戦略**: 一足飛び → 段階的移行
- **モニタリング**: 理想 → 現実的な運用可能性重視

### パターン3: 技術統合性による最適化

- **監視スタック**: ELK → Loki（Prometheusエコシステム統合）
- **アーキテクチャ**: ヘキサゴナル → オニオン（DDD/Event Sourcing適合）

## 将来のADR予定

### 予定されるADR

- **ADR-006**: CI/CD パイプライン設計決定
- **ADR-007**: テスト戦略とQA実装アプローチ
- **ADR-008**: UI/UXデザインシステム採用
- **ADR-009**: データ移行・バックアップ戦略

### Phase別ADR計画

- **Phase 2（実装フェーズ）**: 詳細技術実装決定
- **Phase 3（拡張フェーズ）**: 高度な機能・統合決定
- **Phase 4（本格運用フェーズ）**: 運用・保守戦略決定

## ADR更新・保守

### 更新基準

1. **重要なアーキテクチャ変更**: システム全体に影響する決定
2. **セキュリティ要件変更**: 新たなセキュリティ基準の適用
3. **技術スタック変更**: 主要技術の変更・追加
4. **方針転換**: プロジェクト方向性の大きな変更

### 保守責任

- **主担当**: Software Architect
- **レビュー**: 関連する専門エージェント
- **承認**: Product Manager + Security Officer

### 参照更新

- **四半期レビュー**: ADRの有効性・関連性確認
- **プロジェクト完了時**: 最終的なアーキテクチャ記録の統合
- **運用開始後**: 実運用での課題・改善点の記録

---

**最終更新**: 2025年9月16日
**更新者**: System Architect
**次回レビュー予定**: 2025年12月末（Phase 1完了時）
